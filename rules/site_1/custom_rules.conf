# Custom WAF rules for site 1
# Generated at 2025-04-10T17:37:00+03:00

# Rule ID: 1 - Block /admin
SecRule REQUEST_URI "@rx /admin" "id:100001,phase:1,deny,status:403,log,msg:'Path traversal attempt detected',tag:'CUSTOM-RULE',tag:'PATH-TRAVERSAL'"

# Rule ID: 2 - Test SQL injection
SecRule ARGS "@rx union" "id:100002,phase:2,deny,status:403,log,msg:'SQL injection attempt detected',tag:'CUSTOM-RULE',tag:'SQLI'"

# Rule ID: 3 - Test IP Block
SecRule REMOTE_ADDR "@ipMatch 127.0.0.1" "id:100003,phase:1,deny,status:403,log,msg:'IP blocked: 127.0.0.1',tag:'CUSTOM-RULE',tag:'IP-BLOCK'"

# Rule ID: 4 - Test Rate Limit
SecRule REMOTE_ADDR "." "id:1000041,phase:1,pass,nolog,setvar:tx.100004_counter=+1,expirevar:tx.100004_counter=30"
	SecRule TX:100004_counter "@gt 5" "id:1000042,phase:1,deny,status:429,log,msg:'Rate limit exceeded: 5 requests in 30 seconds',tag:'CUSTOM-RULE',tag:'RATE-LIMIT'"

# Rule ID: 5 - Test Rate
SecRule REMOTE_ADDR "." "id:1000051,phase:1,pass,nolog,setvar:tx.100005_counter=+1,expirevar:tx.100005_counter=40"
	SecRule TX:100005_counter "@gt 5" "id:1000052,phase:1,deny,status:429,log,msg:'Rate limit exceeded: 5 requests in 40 seconds',tag:'CUSTOM-RULE',tag:'RATE-LIMIT'"

